name: Develop to main

on:
  push:
    branches:
      - 'Develop'

jobs: 
  create-pr:
    runs-on: ubuntu-latest
    permissions: 
      contents: write
      pull-requests: write
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Debug GitHub CLI
        run: |
          gh --version
          echo "Github CLI 인증 테스트 ..."
          gh repo view ${{ github.repository }} --json name -q .name
      
      - name: Create PR from Develop to main
        run: |
          echo "Devlope에서 Main으로 PR 생성..."
          gh pr create --base main --head Develop --title "Develop -> main: 자동 머지" --body "Develop 브랜치의 변경사항을 main 브랜치로 자동 머지합니다."
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}